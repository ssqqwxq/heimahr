(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64565e7b"],{4413:function(e,t,n){"use strict";n("e8f6")},"6c35":function(e,t,n){"use strict";n.r(t);n("a4d3"),n("e01a"),n("b0c0");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"app-container"},[t("div",{staticClass:"role-operate"},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showDialog=!0}}},[e._v("添加角色")])],1),t("el-table",{attrs:{data:e.list}},[t("el-table-column",{attrs:{align:"center",width:"200",label:"角色",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row;return[i.isEdit?t("el-input",{model:{value:i.editRow.name,callback:function(t){e.$set(i.editRow,"name",t)},expression:"row.editRow.name"}}):t("span",[e._v(e._s(i.name))])]}}])}),t("el-table-column",{attrs:{align:"center",width:"200",label:"启用",prop:"state"},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row;return[i.isEdit?t("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:i.editRow.state,callback:function(t){e.$set(i.editRow,"state",t)},expression:"row.editRow.state"}}):t("span",[e._v(e._s(i.state?"已启用":"未启用"))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"描述",prop:"description"},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row;return[i.isEdit?t("el-input",{attrs:{type:"textarea"},model:{value:i.editRow.description,callback:function(t){e.$set(i.editRow,"description",t)},expression:"row.editRow.description"}}):t("span",[e._v(e._s(i.description))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row;return[i.isEdit?[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.btnEditOK(i)}}},[e._v("确认")]),t("el-button",{attrs:{type:"info",size:"mini"}},[e._v("取消")])]:[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.btnPermission(i.id)}}},[e._v("分配权限")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.btnEditRow(i)}}},[e._v("编辑")]),t("el-popconfirm",{attrs:{title:"这是一段内容确定删除吗？"},on:{onConfirm:function(t){return e.confirmDel(i.id)}}},[t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("删除")])],1)]]}}])})],1),t("el-row",{staticStyle:{height:"60px"},attrs:{type:"flex",align:"middle",justify:"end"}},[t("el-pagination",{attrs:{layout:"prev, pager, next",total:e.pageParams.total,"page-size":e.pageParams.pagesize,"current-page":e.pageParams.page},on:{"current-change":e.changePage}})],1)],1),t("el-dialog",{attrs:{width:"500px",title:"新增角色",visible:e.showDialog},on:{close:e.btnCancel,"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{prop:"name",label:"角色名称"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{size:"mini"},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),t("el-form-item",{attrs:{label:"启用",prop:"state"}},[t("el-switch",{attrs:{"active-value":1,"inactive-value":0,size:"mini"},model:{value:e.roleForm.state,callback:function(t){e.$set(e.roleForm,"state",t)},expression:"roleForm.state"}})],1),t("el-form-item",{attrs:{prop:"description",label:"角色描述"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea",rows:3,size:"mini"},model:{value:e.roleForm.description,callback:function(t){e.$set(e.roleForm,"description",t)},expression:"roleForm.description"}})],1),t("el-form-item",[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.btnOK}},[e._v("确定")]),t("el-button",{attrs:{size:"mini"},on:{click:e.btnCancel}},[e._v("取消")])],1)],1)],1)],1)],1),t("el-dialog",{attrs:{visible:e.showPermission,title:"分配权限"},on:{"update:visible":function(t){e.showPermission=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.btnPermissionOK}},[e._v("确定")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.showPermission=!1}}},[e._v("取消")])],1)],1)]},proxy:!0}])},[t("el-tree",{ref:"permTree",attrs:{"check-strictly":!0,data:e.permissionData,props:{label:"name"},"default-expand-all":!0,"show-checkbox":!0,"default-checked-keys":e.permIds,"node-key":"id"}})],1)],1)},r=[],a=n("5530"),s=n("c14f"),o=n("1da1"),c=(n("d3b7"),n("0643"),n("4e3e"),n("159b"),n("b775"));function l(e){return Object(c["a"])({url:"/sys/role",params:e})}function u(e){return Object(c["a"])({url:"/sys/role",method:"post",data:e})}function m(e){return Object(c["a"])({url:"/sys/role/".concat(e.id),method:"put",data:e})}function d(e){return Object(c["a"])({url:"/sys/role/".concat(e),method:"DELETE"})}function p(e){return Object(c["a"])({url:"/sys/role/".concat(e)})}function f(e){return Object(c["a"])({url:"/sys/role/assignPrem",method:"put",data:e})}var b=n("0feb"),w=n("ed08"),h={name:"Role",data:function(){return{showDialog:!1,list:[],pageParams:{page:1,pagesize:5,total:0},roleForm:{name:"",description:"",state:0},rules:{name:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],description:[{required:!0,message:"角色描述不能为空",trigger:"blur"}]},showPermission:!1,permissionData:[],currentRoleId:null,permIds:[]}},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){var n,i,r;return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,l(e.pageParams);case 1:n=t.v,i=n.rows,r=n.total,e.list=i,e.pageParams.total=r,i.forEach((function(t){e.$set(t,"isEdit",!1),e.$set(t,"editRow",{name:t.name,state:t.state,description:t.description})}));case 2:return t.a(2)}}),t)})))()},changePage:function(e){this.pageParams.page=e,this.getRoleList()},btnOK:function(){var e=this;this.$refs.roleForm.validate(function(){var t=Object(o["a"])(Object(s["a"])().m((function t(n){return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:if(!n){t.n=2;break}return t.n=1,u(e.roleForm);case 1:e.$message.success("新增角色成功"),e.getRoleList(),e.btnCancel();case 2:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}())},btnCancel:function(){this.$refs.roleForm.resetFields(),this.showDialog=!1},btnEditRow:function(e){e.isEdit=!0,e.editRow.name=e.name,e.editRow.state=e.state,e.editRow.description=e.description},btnEditOK:function(e){var t=this;return Object(o["a"])(Object(s["a"])().m((function n(){return Object(s["a"])().w((function(n){while(1)switch(n.n){case 0:if(!e.editRow.name||!e.editRow.description){n.n=2;break}return n.n=1,m(Object(a["a"])(Object(a["a"])({},e.editRow),{},{id:e.id}));case 1:t.$message.success("编辑成功"),e.name=e.editRow.name,e.state=e.editRow.state,e.description=e.editRow.description,e.isEdit=!1,n.n=3;break;case 2:t.$message.warning("不能为空");case 3:return n.a(2)}}),n)})))()},confirmDel:function(e){var t=this;return Object(o["a"])(Object(s["a"])().m((function n(){return Object(s["a"])().w((function(n){while(1)switch(n.n){case 0:return n.n=1,d(e);case 1:t.$message.success("删除角色成功"),1===t.list.length&&(t.pageParams.page--,t.getRoleList());case 2:return n.a(2)}}),n)})))()},btnPermission:function(e){var t=this;return Object(o["a"])(Object(s["a"])().m((function n(){var i,r,a;return Object(s["a"])().w((function(n){while(1)switch(n.n){case 0:return n.n=1,Object(b["c"])();case 1:return i=n.v,t.permissionData=Object(w["a"])(i,0),t.currentRoleId=e,n.n=2,p(t.currentRoleId);case 2:r=n.v,a=r.permIds,t.permIds=a,t.showPermission=!0;case 3:return n.a(2)}}),n)})))()},btnPermissionOK:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,f({id:e.currentRoleId,permIds:e.$refs.permTree.getCheckedKeys()});case 1:t.v,e.$message.success("角色分配权限成功"),e.showPermission=!1;case 2:return t.a(2)}}),t)})))()}}},g=h,v=(n("4413"),n("2877")),y=Object(v["a"])(g,i,r,!1,null,"01a7102c",null);t["default"]=y.exports},e8f6:function(e,t,n){}}]);